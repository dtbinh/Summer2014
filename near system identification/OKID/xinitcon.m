k1=1.0;k2=2.0;k3=3.0;
m1=1.0;m2=1.0;m3=1.0;ratio=2*0.005;
K=[k1+k2  -k2   0 ;-k2 k2+k3 -k3;0   -k3   k3];
Khalf=sqrtm(K);
Damp=ratio*Khalf;
Ac=[zeros(3,3) eye(3,3);-K -Damp];
Bc=[zeros(3,2);0 0; 1 0; 0 1];
C=[zeros(3,3) eye(3,3)];
x0=[1;1;1;1;1;1];
dt=1.0;pt=100;p=2;
[m,n]=size(C);[n,r]=size(Bc);D=eye(m,r);
t=[dt:dt:pt*dt]';
[A,B]=c2d(Ac,Bc,dt);
clear Ac Bc;
u=randn(pt,r);
y=dlsim(A,B,C,D,u,x0);
[af,bf,cf,df,Gf,x0]=idengine(m,r,dt,u,y,'batch',p,0,[1 0]);
x0=initcond(af,bf,cf,df,Gf(:,1:m),u,y,p);
y_p=yog_cal(af,bf,cf,df,0,u,x0,y,dt,10,1);
y_p=yog_cal(af,bf,cf,df,Gf(:,1:m),u,x0,y,dt,10,1);

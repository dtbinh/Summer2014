<pre class="code">
<span class="srcline"><span class="lineno"><a href="127,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T70U3">yk</span> = measurement_eq_unknown_state(<span class="var type1" id="S3T68U6">xk</span>,<span class="var type1" id="S4T68U7">nk</span>,<span class="var type1" id="S5T4U8">uk</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="127,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% m1: # of known features agent 1 sees</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% m2: # of known features agent 2 sees</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% m = m1 + m2</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,6" id="srcline6">  6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%xk: 17 x 2N+1, inertial position, inertial velocity, inertial quaternion, relative position, and relative quaternion</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%nk: 12+3*m1+3*m2+3*u1+3*u2 x 2N+1, error on range/bearing/azimuth for agent 1, then agent 2, then magnetometer errors for agent 1 then 2, </span></span></span>
<span class="srcline"><span class="lineno"><a href="127,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%       THEN feature range/bearing/azimuth errors FOR EACH KNOWN FEATURE</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%       for agent 1, then same for agent 2, THEN AGAIN for unknown features for 1, then 2 </span></span></span>
<span class="srcline"><span class="lineno"><a href="127,11" id="srcline11"> 11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%uk[wi;ai;mag_i;# of i known features;rkn;<span class="keyword">...</span><span class="comment">;# of j features;rkn;...; # of i unknown features; indices of i unknown features; </span></span></span></span>
<span class="srcline"><span class="lineno"><a href="127,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   # of j unknown features; indices of j unknown features] : 9+2+3*m+3*w1+3*w2 x 2N+1, m being total # of features from i and j </span></span></span>
<span class="srcline"><span class="lineno"><a href="127,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo" id="T33:U5"><span class="var type1" id="S6T33U11">mag_i</span> = <span class="mxinfo" id="T33:U7"><span class="var type1" id="S5T4U13">uk</span>(<span class="mxinfo" id="T49:U9"><span class="mxinfo" id="T3:U10">7</span>:<span class="mxinfo" id="T3:U11">9</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,16" id="srcline16"> 16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo" id="T3:U12"><span class="var type1" id="S7T3U19">m1</span> = <span class="mxinfo" id="T3:U14"><span class="var type1" id="S5T4U21">uk</span>(<span class="mxinfo" id="T3:U16">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo" id="T3:U17"><span class="var type1" id="S8T3U25">m2</span> = <span class="mxinfo" id="T3:U19"><span class="var type1" id="S5T4U27">uk</span>(<span class="mxinfo" id="T3:U21"><span class="mxinfo" id="T3:U22"><span class="mxinfo" id="T3:U23">10</span>+<span class="mxinfo" id="T3:U24"><span class="mxinfo" id="T3:U25">3</span>*<span class="var type1" id="S7T3U33">m1</span></span></span>+<span class="mxinfo" id="T3:U27">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo" id="T3:U28"><span class="var type1" id="S9T3U37">m</span> = <span class="mxinfo" id="T3:U30"><span class="var type1" id="S7T3U39">m1</span>+<span class="var type1" id="S8T3U40">m2</span></span></span>;<span class="comment">% total # of features</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo" id="T3:U33"><span class="var type1" id="S10T3U43">w1</span> = <span class="mxinfo" id="T3:U35"><span class="var type1" id="S5T4U45">uk</span>(<span class="mxinfo" id="T3:U37"><span class="mxinfo" id="T3:U38"><span class="mxinfo" id="T3:U39"><span class="mxinfo" id="T3:U40">10</span> + <span class="mxinfo" id="T3:U41">2</span></span> + <span class="mxinfo" id="T3:U42"><span class="mxinfo" id="T3:U43">3</span>*<span class="var type1" id="S7T3U53">m1</span></span></span> + <span class="mxinfo" id="T3:U45"><span class="mxinfo" id="T3:U46">3</span>*<span class="var type1" id="S8T3U56">m2</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo" id="T3:U48"><span class="var type1" id="S11T3U59">w2</span> = <span class="mxinfo" id="T3:U50"><span class="var type1" id="S5T4U61">uk</span>(<span class="mxinfo" id="T3:U52"><span class="mxinfo" id="T3:U53"><span class="mxinfo" id="T3:U54"><span class="mxinfo" id="T3:U55"><span class="mxinfo" id="T3:U56"><span class="mxinfo" id="T3:U57">10</span> + <span class="mxinfo" id="T3:U58">2</span></span> + <span class="mxinfo" id="T3:U59"><span class="mxinfo" id="T3:U60">3</span>*<span class="var type1" id="S7T3U71">m1</span></span></span> + <span class="mxinfo" id="T3:U62"><span class="mxinfo" id="T3:U63">3</span>*<span class="var type1" id="S8T3U74">m2</span></span></span> + <span class="var type1" id="S10T3U75">w1</span></span> + <span class="mxinfo" id="T3:U66">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,22" id="srcline22"> 22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% 3 x m1 array of known inertial position of features seen by agent 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T9:U67"><span class="var type1" id="S7T3U80">m1</span> &gt; <span class="mxinfo" id="T3:U69">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="127,25" id="srcline25"> 25</a></span><span class="line">    <span class="mxinfo" id="T74:U70"><span class="var type1" id="S12T74U84">RKN_1</span> = <span class="mxinfo" id="T96:U72"><span class="mxinfo" id="T75:U73">reshape(<span class="mxinfo" id="T2:U74"><span class="var type1" id="S5T4U89">uk</span>(<span class="mxinfo" id="T18:U76"><span class="mxinfo" id="T3:U77">10</span>+(<span class="mxinfo" id="T18:U78">1:<span class="mxinfo" id="T3:U79"><span class="var type1" id="S7T3U96">m1</span>*<span class="mxinfo" id="T3:U81">3</span></span></span>)</span>)</span>,3,[])</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,26" id="srcline26"> 26</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo" id="T74:U82"><span class="var type1" id="S12T74U104">RKN_1</span> = <span class="mxinfo" id="T30:U84">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,28" id="srcline28"> 28</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% 3 x m2 array of known inertial position of features seen by agent 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,30" id="srcline30"> 30</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T9:U85"><span class="var type1" id="S8T3U110">m2</span> &gt; <span class="mxinfo" id="T3:U87">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="127,31" id="srcline31"> 31</a></span><span class="line">    <span class="mxinfo" id="T74:U88"><span class="var type1" id="S14T74U114">RKN_2</span> = <span class="mxinfo" id="T96:U90"><span class="mxinfo" id="T75:U91">reshape(<span class="mxinfo" id="T2:U92"><span class="var type1" id="S5T4U119">uk</span>(<span class="mxinfo" id="T18:U94"><span class="mxinfo" id="T3:U95"><span class="mxinfo" id="T3:U96">11</span>+<span class="mxinfo" id="T3:U97"><span class="mxinfo" id="T3:U98">3</span>*<span class="var type1" id="S7T3U125">m1</span></span></span>+(<span class="mxinfo" id="T18:U100">1:<span class="mxinfo" id="T3:U101"><span class="mxinfo" id="T3:U102">3</span>*<span class="var type1" id="S8T3U131">m2</span></span></span>)</span>)</span>,3,[])</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,32" id="srcline32"> 32</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo" id="T74:U104"><span class="var type1" id="S14T74U138">RKN_2</span> = <span class="mxinfo" id="T30:U106">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,34" id="srcline34"> 34</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% feature indices of unknown features</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T2:U107"><span class="var type1" id="S15T2U143">feature_index_1</span> = <span class="mxinfo" id="T2:U109"><span class="var type1" id="S5T4U145">uk</span>(<span class="mxinfo" id="T18:U111"><span class="mxinfo" id="T3:U112"><span class="mxinfo" id="T3:U113">12</span> + <span class="mxinfo" id="T3:U114"><span class="mxinfo" id="T3:U115">3</span>*(<span class="mxinfo" id="T3:U116"><span class="var type1" id="S7T3U153">m1</span>+<span class="var type1" id="S8T3U154">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U119">1:<span class="var type1" id="S10T3U158">w1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">% feature indices of other agent's unknown features</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T2:U121"><span class="var type1" id="S16T2U161">feature_index_2</span> = <span class="mxinfo" id="T2:U123"><span class="var type1" id="S5T4U163">uk</span>(<span class="mxinfo" id="T18:U125"><span class="mxinfo" id="T3:U126"><span class="mxinfo" id="T3:U127"><span class="mxinfo" id="T3:U128"><span class="mxinfo" id="T3:U129">12</span> + <span class="mxinfo" id="T3:U130"><span class="mxinfo" id="T3:U131">3</span>*(<span class="mxinfo" id="T3:U132"><span class="var type1" id="S7T3U173">m1</span>+<span class="var type1" id="S8T3U174">m2</span></span>)</span></span> + <span class="mxinfo" id="T3:U135">1</span></span> + <span class="var type1" id="S10T3U176">w1</span></span> + (<span class="mxinfo" id="T18:U137">1:<span class="var type1" id="S11T3U180">w2</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T3:U139"><span class="var type1" id="S17T3U183">n</span> = <span class="mxinfo" id="T3:U141">size(<span class="var type1" id="S3T68U186">xk</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo" id="T3:U143"><span class="var type1" id="S19T3U190">l</span> = <span class="mxinfo" id="T3:U145">size(<span class="var type1" id="S4T68U193">nk</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,42" id="srcline42"> 42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T70:U147"><span class="var type1" id="S2T70U197">yk</span> = <span class="mxinfo" id="T70:U149">zeros(<span class="mxinfo" id="T3:U150"><span class="mxinfo" id="T3:U151">9</span>+<span class="mxinfo" id="T3:U152"><span class="mxinfo" id="T3:U153">3</span>*(<span class="mxinfo" id="T3:U154"><span class="mxinfo" id="T3:U155"><span class="var type1" id="S9T3U207">m</span>+<span class="var type1" id="S10T3U208">w1</span></span>+<span class="var type1" id="S11T3U209">w2</span></span>)</span></span>,<span class="mxinfo" id="T3:U159">size(<span class="var type1" id="S3T68U212">xk</span>,2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,44" id="srcline44"> 44</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T3U216">k</span> = <span class="mxinfo" id="T3:U162">1</span>:<span class="mxinfo" id="T3:U163">size(<span class="var type1" id="S3T68U221">xk</span>,2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,45" id="srcline45"> 45</a></span><span class="line">    <span class="mxinfo" id="T1:U165"><span class="var type1" id="S22T1U225">xhat</span> = <span class="mxinfo" id="T1:U167"><span class="var type1" id="S3T68U227">xk</span>(:,<span class="var type1" id="S21T3U229">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,46" id="srcline46"> 46</a></span><span class="line">    <span class="comment">% i to j frame transform</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,47" id="srcline47"> 47</a></span><span class="line">    <span class="mxinfo" id="T43:U170"><span class="var type1" id="S23T43U232">qhat</span> = <span class="mxinfo" id="T43:U172"><span class="var type1" id="S3T68U234">xk</span>(<span class="mxinfo" id="T84:U174"><span class="mxinfo" id="T3:U175">14</span>:<span class="mxinfo" id="T3:U176">17</span></span>,<span class="var type1" id="S21T3U238">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,48" id="srcline48"> 48</a></span><span class="line">    <span class="comment">% est relative position in my (i) frame</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo" id="T33:U178"><span class="var type1" id="S24T33U241">rji_i_hat</span> = <span class="mxinfo" id="T33:U180"><span class="var type1" id="S3T68U243">xk</span>(<span class="mxinfo" id="T49:U182"><span class="mxinfo" id="T3:U183">11</span>:<span class="mxinfo" id="T3:U184">13</span></span>,<span class="var type1" id="S21T3U247">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,50" id="srcline50"> 50</a></span><span class="line">    <span class="comment">% estimated my inertial position</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo" id="T33:U186"><span class="var type1" id="S25T33U250">rin</span> = <span class="mxinfo" id="T33:U188"><span class="var type1" id="S3T68U252">xk</span>(<span class="mxinfo" id="T49:U190"><span class="mxinfo" id="T3:U191">1</span>:<span class="mxinfo" id="T3:U192">3</span></span>,<span class="var type1" id="S21T3U256">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,52" id="srcline52"> 52</a></span><span class="line">    <span class="comment">% my estimated inertial attitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T43:U194"><span class="var type1" id="S26T43U259">qin</span> = <span class="mxinfo" id="T43:U196"><span class="var type1" id="S3T68U261">xk</span>(<span class="mxinfo" id="T84:U198"><span class="mxinfo" id="T3:U199">7</span>:<span class="mxinfo" id="T3:U200">10</span></span>,<span class="var type1" id="S21T3U265">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T44:U202"><span class="var type1" id="S27T44U268">Cin</span> = <span class="mxinfo" id="T44:U204"><span class="fcn" id="F352N2:B270">attparsilentmex</span>(<span class="var type1" id="S26T43U271">qin</span>,[6 1])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,55" id="srcline55"> 55</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T1:U206"><span class="var type1" id="S29T1U278">nv</span> = <span class="mxinfo" id="T1:U208"><span class="var type1" id="S4T68U280">nk</span>(:,<span class="var type1" id="S21T3U282">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,57" id="srcline57"> 57</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo" id="T44:U211"><span class="var type1" id="S30T44U285">Cji</span> = <span class="mxinfo" id="T44:U213"><span class="fcn" id="F352N2:B287">attparsilentmex</span>(<span class="var type1" id="S23T43U288">qhat</span>,[6 1])</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,59" id="srcline59"> 59</a></span><span class="line">    <span class="comment">% expected range/bearing/azimuth from agent i's measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo" id="T33:U215"><span class="mxinfo" id="T33:U216"><span class="var type1" id="S2T70U296">yk</span>(<span class="mxinfo" id="T49:U218"><span class="mxinfo" id="T3:U219">1</span>:<span class="mxinfo" id="T3:U220">3</span></span>,<span class="var type1" id="S21T3U300">k</span>)</span> = <span class="mxinfo" id="T33:U222"><span class="mxinfo" id="T33:U223">[<span class="mxinfo" id="T3:U224">sqrt(<span class="mxinfo" id="T3:U225">sum(<span class="mxinfo" id="T33:U226"><span class="var type1" id="S24T33U309">rji_i_hat</span>.^2</span>)</span>)</span>;<span class="mxinfo" id="T3:U228">atan2(<span class="mxinfo" id="T3:U229"><span class="var type1" id="S24T33U315">rji_i_hat</span>(<span class="mxinfo" id="T3:U231">2</span>)</span>,<span class="mxinfo" id="T3:U232"><span class="var type1" id="S24T33U318">rji_i_hat</span>(<span class="mxinfo" id="T3:U234">1</span>)</span>)</span>;<span class="mxinfo" id="T3:U235">atan2(<span class="mxinfo" id="T3:U236"><span class="var type1" id="S24T33U324">rji_i_hat</span>(<span class="mxinfo" id="T3:U238">3</span>)</span>,<span class="mxinfo" id="T3:U239">sqrt(<span class="mxinfo" id="T3:U240">sum(<span class="mxinfo" id="T48:U241"><span class="mxinfo" id="T48:U242"><span class="var type1" id="S24T33U332">rji_i_hat</span>(<span class="mxinfo" id="T35:U244"><span class="mxinfo" id="T3:U245">1</span>:<span class="mxinfo" id="T3:U246">2</span></span>)</span>.^2</span>)</span>)</span>)</span>]</span> + <span class="mxinfo" id="T33:U247"><span class="var type1" id="S29T1U338">nv</span>(<span class="mxinfo" id="T49:U249"><span class="mxinfo" id="T3:U250">1</span>:<span class="mxinfo" id="T3:U251">3</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,62" id="srcline62"> 62</a></span><span class="line">    <span class="comment">% expectated relative vector from agent j's measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo" id="T33:U252"><span class="var type1" id="S34T33U344">rij_j_hat</span> = <span class="mxinfo" id="T33:U254"><span class="mxinfo" id="T44:U255">-<span class="var type1" id="S30T44U347">Cji</span></span>*<span class="var type1" id="S24T33U348">rji_i_hat</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,64" id="srcline64"> 64</a></span><span class="line">    <span class="comment">% expected range/bearing/azimuth from agent j's measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo" id="T33:U258"><span class="mxinfo" id="T33:U259"><span class="var type1" id="S2T70U352">yk</span>(<span class="mxinfo" id="T49:U261"><span class="mxinfo" id="T3:U262">4</span>:<span class="mxinfo" id="T3:U263">6</span></span>,<span class="var type1" id="S21T3U356">k</span>)</span> = <span class="mxinfo" id="T33:U265"><span class="mxinfo" id="T33:U266">[<span class="mxinfo" id="T3:U267">sqrt(<span class="mxinfo" id="T3:U268">sum(<span class="mxinfo" id="T33:U269"><span class="var type1" id="S34T33U365">rij_j_hat</span>.^2</span>)</span>)</span>;<span class="mxinfo" id="T3:U271">atan2(<span class="mxinfo" id="T3:U272"><span class="var type1" id="S34T33U371">rij_j_hat</span>(<span class="mxinfo" id="T3:U274">2</span>)</span>,<span class="mxinfo" id="T3:U275"><span class="var type1" id="S34T33U374">rij_j_hat</span>(<span class="mxinfo" id="T3:U277">1</span>)</span>)</span>;<span class="mxinfo" id="T3:U278">atan2(<span class="mxinfo" id="T3:U279"><span class="var type1" id="S34T33U380">rij_j_hat</span>(<span class="mxinfo" id="T3:U281">3</span>)</span>,<span class="mxinfo" id="T3:U282">sqrt(<span class="mxinfo" id="T3:U283">sum(<span class="mxinfo" id="T48:U284"><span class="mxinfo" id="T48:U285"><span class="var type1" id="S34T33U388">rij_j_hat</span>(<span class="mxinfo" id="T35:U287"><span class="mxinfo" id="T3:U288">1</span>:<span class="mxinfo" id="T3:U289">2</span></span>)</span>.^2</span>)</span>)</span>)</span>]</span> + <span class="mxinfo" id="T33:U290"><span class="var type1" id="S29T1U394">nv</span>(<span class="mxinfo" id="T49:U292"><span class="mxinfo" id="T3:U293">4</span>:<span class="mxinfo" id="T3:U294">6</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,66" id="srcline66"> 66</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,67" id="srcline67"> 67</a></span><span class="line">    <span class="comment">% expected magnetometer measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,68" id="srcline68"> 68</a></span><span class="line">    <span class="mxinfo" id="T33:U295"><span class="mxinfo" id="T33:U296"><span class="var type1" id="S2T70U401">yk</span>(<span class="mxinfo" id="T49:U298"><span class="mxinfo" id="T3:U299">7</span>:<span class="mxinfo" id="T3:U300">9</span></span>,<span class="var type1" id="S21T3U405">k</span>)</span> = <span class="mxinfo" id="T33:U302"><span class="mxinfo" id="T33:U303"><span class="var type1" id="S30T44U408">Cji</span>*(<span class="mxinfo" id="T33:U305"><span class="var type1" id="S6T33U411">mag_i</span> + <span class="mxinfo" id="T33:U307"><span class="var type1" id="S29T1U413">nv</span>(<span class="mxinfo" id="T49:U309"><span class="mxinfo" id="T3:U310">7</span>:<span class="mxinfo" id="T3:U311">9</span></span>)</span></span>)</span> - <span class="mxinfo" id="T33:U312"><span class="var type1" id="S29T1U418">nv</span>(<span class="mxinfo" id="T49:U314"><span class="mxinfo" id="T3:U315">10</span>:<span class="mxinfo" id="T3:U316">12</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,69" id="srcline69"> 69</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,70" id="srcline70"> 70</a></span><span class="line">    <span class="comment">% known feature measurements agent 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,71" id="srcline71"> 71</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S35T3U424">kk</span> = <span class="mxinfo" id="T3:U318">1</span>:<span class="var type1" id="S7T3U427">m1</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,72" id="srcline72"> 72</a></span><span class="line">        <span class="comment">% get the i frame vector to the feature</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,73" id="srcline73"> 73</a></span><span class="line">        <span class="mxinfo" id="T33:U320"><span class="var type1" id="S36T33U430">rki</span> = <span class="mxinfo" id="T33:U322"><span class="var type1" id="S27T44U432">Cin</span>*(<span class="mxinfo" id="T33:U324"><span class="mxinfo" id="T97:U325"><span class="mxinfo" id="T98:U326"><span class="var type1" id="S12T74U437">RKN_1</span>(<span class="var type1" id="S35T3U438">kk</span>,:)</span>'</span> - <span class="var type1" id="S25T33U440">rin</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,74" id="srcline74"> 74</a></span><span class="line">        <span class="comment">% the index for now</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,75" id="srcline75"> 75</a></span><span class="line">        <span class="mxinfo" id="T49:U330"><span class="var type1" id="S37T49U443">index</span> = <span class="mxinfo" id="T49:U332"><span class="mxinfo" id="T3:U333">(<span class="mxinfo" id="T3:U334"><span class="var type1" id="S35T3U448">kk</span>-<span class="mxinfo" id="T3:U336">1</span></span>)*<span class="mxinfo" id="T3:U337">3</span></span> + (<span class="mxinfo" id="T49:U338">1:3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,76" id="srcline76"> 76</a></span><span class="line">        <span class="comment">% compute range/bearing/declination</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,77" id="srcline77"> 77</a></span><span class="line">        <span class="comment">%y_kk = [sqrt(sum(rki.^2));atan2(rki(2),rki(1));atan2(rki(3),sqrt(sum(rki(1:2).^2)))] + nv(12 + index);</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,78" id="srcline78"> 78</a></span><span class="line">        <span class="mxinfo" id="T33:U339"><span class="var type1" id="S38T33U457">y_kk</span> = <span class="mxinfo" id="T33:U341"><span class="mxinfo" id="T33:U342"><span class="fcn" id="F507N14:B460">vector2polar</span>(<span class="var type1" id="S36T33U461">rki</span>)</span> + <span class="mxinfo" id="T33:U344"><span class="var type1" id="S29T1U463">nv</span>(<span class="mxinfo" id="T49:U346"><span class="mxinfo" id="T3:U347">12</span> + <span class="var type1" id="S37T49U466">index</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo" id="T33:U349"><span class="mxinfo" id="T33:U350"><span class="var type1" id="S2T70U470">yk</span>(<span class="mxinfo" id="T49:U352"><span class="mxinfo" id="T3:U353">9</span> + <span class="var type1" id="S37T49U473">index</span></span>,<span class="var type1" id="S21T3U474">k</span>)</span> = <span class="var type1" id="S38T33U475">y_kk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,80" id="srcline80"> 80</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,81" id="srcline81"> 81</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,82" id="srcline82"> 82</a></span><span class="line">    <span class="comment">% known feature measurements agent 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,83" id="srcline83"> 83</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S35T3U478">kk</span> = <span class="mxinfo" id="T3:U358">1</span>:<span class="var type1" id="S8T3U481">m2</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,84" id="srcline84"> 84</a></span><span class="line">        <span class="comment">% get the j frame vector to the feature</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,85" id="srcline85"> 85</a></span><span class="line">        <span class="mxinfo" id="T33:U360"><span class="var type1" id="S40T33U484">rkj</span> = <span class="mxinfo" id="T33:U362"><span class="mxinfo" id="T44:U363"><span class="var type1" id="S30T44U487">Cji</span>*<span class="var type1" id="S27T44U488">Cin</span></span>*(<span class="mxinfo" id="T33:U366"><span class="mxinfo" id="T33:U367"><span class="mxinfo" id="T97:U368"><span class="mxinfo" id="T98:U369"><span class="var type1" id="S14T74U494">RKN_2</span>(<span class="var type1" id="S35T3U495">kk</span>,:)</span>'</span> - <span class="mxinfo" id="T33:U372"><span class="mxinfo" id="T44:U373"><span class="var type1" id="S27T44U499">Cin</span>'</span>*<span class="var type1" id="S24T33U500">rji_i_hat</span></span></span> - <span class="var type1" id="S25T33U501">rin</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,86" id="srcline86"> 86</a></span><span class="line">        <span class="comment">% the index for now</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,87" id="srcline87"> 87</a></span><span class="line">        <span class="mxinfo" id="T49:U377"><span class="var type1" id="S37T49U504">index</span> = <span class="mxinfo" id="T49:U379"><span class="mxinfo" id="T49:U380"><span class="mxinfo" id="T3:U381">(<span class="mxinfo" id="T3:U382"><span class="var type1" id="S35T3U510">kk</span>-<span class="mxinfo" id="T3:U384">1</span></span>)*<span class="mxinfo" id="T3:U385">3</span></span> + (<span class="mxinfo" id="T49:U386">1:3</span>)</span> + <span class="mxinfo" id="T3:U387"><span class="var type1" id="S7T3U518">m1</span>*<span class="mxinfo" id="T3:U389">3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,88" id="srcline88"> 88</a></span><span class="line">        <span class="comment">% compute range/bearing/declination</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,89" id="srcline89"> 89</a></span><span class="line">        <span class="comment">%y_kk = [sqrt(sum(rkj.^2));atan2(rkj(2),rkj(1));atan2(rkj(3),sqrt(sum(rkj(1:2).^2)))] + nv(12 + index);</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo" id="T33:U390"><span class="var type1" id="S38T33U522">y_kk</span> = <span class="mxinfo" id="T33:U392"><span class="mxinfo" id="T33:U393"><span class="fcn" id="F507N14:B525">vector2polar</span>(<span class="var type1" id="S40T33U526">rkj</span>)</span> + <span class="mxinfo" id="T33:U395"><span class="var type1" id="S29T1U528">nv</span>(<span class="mxinfo" id="T49:U397"><span class="mxinfo" id="T3:U398">12</span> + <span class="var type1" id="S37T49U531">index</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo" id="T33:U400"><span class="mxinfo" id="T33:U401"><span class="var type1" id="S2T70U535">yk</span>(<span class="mxinfo" id="T49:U403"><span class="mxinfo" id="T3:U404">9</span> + <span class="var type1" id="S37T49U538">index</span></span>,<span class="var type1" id="S21T3U539">k</span>)</span> = <span class="var type1" id="S38T33U540">y_kk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,92" id="srcline92"> 92</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,93" id="srcline93"> 93</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,94" id="srcline94"> 94</a></span><span class="line">    <span class="comment">% unknown feature measurements agent 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,95" id="srcline95"> 95</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S35T3U543">kk</span> = <span class="mxinfo" id="T3:U409">1</span>:<span class="var type1" id="S10T3U546">w1</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,96" id="srcline96"> 96</a></span><span class="line">        <span class="comment">% the index for where to store these data</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo" id="T49:U411"><span class="var type1" id="S37T49U549">index</span> = <span class="mxinfo" id="T49:U413"><span class="mxinfo" id="T49:U414"><span class="mxinfo" id="T3:U415">(<span class="mxinfo" id="T3:U416"><span class="var type1" id="S35T3U555">kk</span>-<span class="mxinfo" id="T3:U418">1</span></span>)*<span class="mxinfo" id="T3:U419">3</span></span> + (<span class="mxinfo" id="T49:U420">1:3</span>)</span> + <span class="mxinfo" id="T3:U421">(<span class="mxinfo" id="T3:U422"><span class="var type1" id="S7T3U565">m1</span>+<span class="var type1" id="S8T3U566">m2</span></span>)*<span class="mxinfo" id="T3:U425">3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,98" id="srcline98"> 98</a></span><span class="line">        <span class="comment">% the label for this feature</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,99" id="srcline99"> 99</a></span><span class="line">        <span class="mxinfo" id="T3:U426"><span class="var type1" id="S41T3U570">feature_no</span> = <span class="mxinfo" id="T3:U428"><span class="var type1" id="S15T2U572">feature_index_1</span>(<span class="var type1" id="S35T3U573">kk</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,100" id="srcline100">100</a></span><span class="line">        <span class="mxinfo" id="T51:U431"><span class="var type1" id="S42T51U576">feature_vec</span> = <span class="mxinfo" id="T51:U433"><span class="var type1" id="S22T1U578">xhat</span>(<span class="mxinfo" id="T50:U435"><span class="mxinfo" id="T3:U436"><span class="mxinfo" id="T3:U437">17</span> + <span class="mxinfo" id="T3:U438">(<span class="mxinfo" id="T3:U439"><span class="var type1" id="S41T3U585">feature_no</span>-<span class="mxinfo" id="T3:U441">1</span></span>)*<span class="mxinfo" id="T3:U442">6</span></span></span> + (<span class="mxinfo" id="T50:U443">1:6</span>)</span>)</span></span>;<span class="comment">%xyz,rho,bearing,azimuth</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,101" id="srcline101">101</a></span><span class="line">        <span class="comment">% the inertial vector to the feature, in inertial frame</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,102" id="srcline102">102</a></span><span class="line">        <span class="mxinfo" id="T33:U444"><span class="var type1" id="S43T33U594">rkn</span> = <span class="mxinfo" id="T33:U446"><span class="mxinfo" id="T33:U447"><span class="var type1" id="S42T51U597">feature_vec</span>(<span class="mxinfo" id="T49:U449"><span class="mxinfo" id="T3:U450">1</span>:<span class="mxinfo" id="T3:U451">3</span></span>)</span> + <span class="mxinfo" id="T33:U452"><span class="mxinfo" id="T3:U453"><span class="mxinfo" id="T3:U454">1</span>/<span class="mxinfo" id="T3:U455"><span class="var type1" id="S42T51U605">feature_vec</span>(<span class="mxinfo" id="T3:U457">4</span>)</span></span>*<span class="mxinfo" id="T33:U458">[<span class="mxinfo" id="T48:U459"><span class="mxinfo" id="T3:U460">cos(<span class="mxinfo" id="T3:U461"><span class="var type1" id="S42T51U613">feature_vec</span>(<span class="mxinfo" id="T3:U463">6</span>)</span>)</span>*<span class="mxinfo" id="T48:U464">[<span class="mxinfo" id="T3:U465">cos(<span class="mxinfo" id="T3:U466"><span class="var type1" id="S42T51U620">feature_vec</span>(<span class="mxinfo" id="T3:U468">6</span>)</span>)</span>;<span class="mxinfo" id="T3:U469">sin(<span class="mxinfo" id="T3:U470"><span class="var type1" id="S42T51U626">feature_vec</span>(<span class="mxinfo" id="T3:U472">6</span>)</span>)</span>]</span></span>; <span class="mxinfo" id="T3:U473">sin(<span class="mxinfo" id="T3:U474"><span class="var type1" id="S42T51U632">feature_vec</span>(<span class="mxinfo" id="T3:U476">6</span>)</span>)</span>]</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,103" id="srcline103">103</a></span><span class="line">        <span class="comment">% the body-frame vector to the feature</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,104" id="srcline104">104</a></span><span class="line">        <span class="mxinfo" id="T33:U477"><span class="var type1" id="S46T33U636">rki_b</span> = <span class="mxinfo" id="T33:U479"><span class="var type1" id="S27T44U638">Cin</span>*(<span class="mxinfo" id="T33:U481"><span class="var type1" id="S43T33U641">rkn</span> - <span class="var type1" id="S25T33U642">rin</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,105" id="srcline105">105</a></span><span class="line">        <span class="comment">% extract range/bearing/azimuth</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,106" id="srcline106">106</a></span><span class="line">        <span class="mxinfo" id="T33:U484"><span class="var type1" id="S38T33U645">y_kk</span> = <span class="mxinfo" id="T33:U486"><span class="mxinfo" id="T33:U487"><span class="fcn" id="F507N14:B648">vector2polar</span>(<span class="var type1" id="S46T33U649">rki_b</span>)</span> + <span class="mxinfo" id="T33:U489"><span class="var type1" id="S29T1U651">nv</span>(<span class="mxinfo" id="T49:U491"><span class="mxinfo" id="T3:U492">12</span> + <span class="var type1" id="S37T49U654">index</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,107" id="srcline107">107</a></span><span class="line">        <span class="mxinfo" id="T33:U494"><span class="mxinfo" id="T33:U495"><span class="var type1" id="S2T70U658">yk</span>(<span class="mxinfo" id="T49:U497"><span class="mxinfo" id="T3:U498">9</span> + <span class="var type1" id="S37T49U661">index</span></span>,<span class="var type1" id="S21T3U662">k</span>)</span> = <span class="var type1" id="S38T33U663">y_kk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,108" id="srcline108">108</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,109" id="srcline109">109</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="127,110" id="srcline110">110</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T9:U502"><span class="var type1" id="S21T3U667">k</span> &gt; <span class="mxinfo" id="T3:U504">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="127,111" id="srcline111">111</a></span><span class="line">        <span class="comment">% minimize all angle differences</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,112" id="srcline112">112</a></span><span class="line">        <span class="mxinfo" id="T43:U505"><span class="mxinfo" id="T43:U506"><span class="var type1" id="S2T70U672">yk</span>(<span class="mxinfo" id="T43:U508">[<span class="mxinfo" id="T3:U509">2</span>;<span class="mxinfo" id="T3:U510">3</span>;<span class="mxinfo" id="T3:U511">5</span>;<span class="mxinfo" id="T3:U512">6</span>]</span>,<span class="var type1" id="S21T3U682">k</span>)</span> = <span class="mxinfo" id="T43:U514"><span class="fcn" id="F554N9:B684">minangle</span>(<span class="mxinfo" id="T43:U515"><span class="var type1" id="S2T70U686">yk</span>(<span class="mxinfo" id="T43:U517">[<span class="mxinfo" id="T3:U518">2</span>;<span class="mxinfo" id="T3:U519">3</span>;<span class="mxinfo" id="T3:U520">5</span>;<span class="mxinfo" id="T3:U521">6</span>]</span>,<span class="var type1" id="S21T3U696">k</span>)</span>,<span class="mxinfo" id="T43:U523"><span class="var type1" id="S2T70U698">yk</span>(<span class="mxinfo" id="T43:U525">[<span class="mxinfo" id="T3:U526">2</span>;<span class="mxinfo" id="T3:U527">3</span>;<span class="mxinfo" id="T3:U528">5</span>;<span class="mxinfo" id="T3:U529">6</span>]</span>,<span class="mxinfo" id="T3:U530">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,113" id="srcline113">113</a></span><span class="line">        <span class="mxinfo" id="T2:U531"><span class="mxinfo" id="T2:U532"><span class="var type1" id="S2T70U712">yk</span>( <span class="mxinfo" id="T18:U534"><span class="mxinfo" id="T3:U535">9</span> + (<span class="mxinfo" id="T18:U536">2:3:<span class="mxinfo" id="T3:U537"><span class="mxinfo" id="T3:U538">3</span>*<span class="var type1" id="S7T3U722">m1</span></span></span>)</span>,<span class="var type1" id="S21T3U723">k</span> )</span> = <span class="mxinfo" id="T2:U541"><span class="fcn" id="F582N9:B725">minangle</span>(<span class="mxinfo" id="T2:U542"><span class="var type1" id="S2T70U727">yk</span>(<span class="mxinfo" id="T18:U544"><span class="mxinfo" id="T3:U545">9</span> + (<span class="mxinfo" id="T18:U546">2:3:<span class="mxinfo" id="T3:U547"><span class="mxinfo" id="T3:U548">3</span>*<span class="var type1" id="S7T3U737">m1</span></span></span>)</span>,<span class="var type1" id="S21T3U738">k</span>)</span>,<span class="mxinfo" id="T2:U551"><span class="var type1" id="S2T70U740">yk</span>(<span class="mxinfo" id="T18:U553"><span class="mxinfo" id="T3:U554">9</span> + (<span class="mxinfo" id="T18:U555">2:3:<span class="mxinfo" id="T3:U556"><span class="mxinfo" id="T3:U557">3</span>*<span class="var type1" id="S7T3U750">m1</span></span></span>)</span>,<span class="mxinfo" id="T3:U559">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,114" id="srcline114">114</a></span><span class="line">        <span class="mxinfo" id="T2:U560"><span class="mxinfo" id="T2:U561"><span class="var type1" id="S2T70U755">yk</span>( <span class="mxinfo" id="T18:U563"><span class="mxinfo" id="T3:U564">9</span> + (<span class="mxinfo" id="T18:U565">3:3:<span class="mxinfo" id="T3:U566"><span class="mxinfo" id="T3:U567">3</span>*<span class="var type1" id="S7T3U765">m1</span></span></span>)</span>,<span class="var type1" id="S21T3U766">k</span> )</span> = <span class="mxinfo" id="T2:U570"><span class="fcn" id="F582N9:B768">minangle</span>(<span class="mxinfo" id="T2:U571"><span class="var type1" id="S2T70U770">yk</span>(<span class="mxinfo" id="T18:U573"><span class="mxinfo" id="T3:U574">9</span> + (<span class="mxinfo" id="T18:U575">3:3:<span class="mxinfo" id="T3:U576"><span class="mxinfo" id="T3:U577">3</span>*<span class="var type1" id="S7T3U780">m1</span></span></span>)</span>,<span class="var type1" id="S21T3U781">k</span>)</span>,<span class="mxinfo" id="T2:U580"><span class="var type1" id="S2T70U783">yk</span>(<span class="mxinfo" id="T18:U582"><span class="mxinfo" id="T3:U583">9</span> + (<span class="mxinfo" id="T18:U584">3:3:<span class="mxinfo" id="T3:U585"><span class="mxinfo" id="T3:U586">3</span>*<span class="var type1" id="S7T3U793">m1</span></span></span>)</span>,<span class="mxinfo" id="T3:U588">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,115" id="srcline115">115</a></span><span class="line">        <span class="mxinfo" id="T2:U589"><span class="mxinfo" id="T2:U590"><span class="var type1" id="S2T70U798">yk</span>( <span class="mxinfo" id="T18:U592"><span class="mxinfo" id="T3:U593"><span class="mxinfo" id="T3:U594">9</span> + <span class="mxinfo" id="T3:U595"><span class="mxinfo" id="T3:U596">3</span>*<span class="var type1" id="S7T3U804">m1</span></span></span> + (<span class="mxinfo" id="T18:U598">2:3:<span class="mxinfo" id="T3:U599"><span class="mxinfo" id="T3:U600">3</span>*<span class="var type1" id="S8T3U812">m2</span></span></span>)</span>,<span class="var type1" id="S21T3U813">k</span> )</span> = <span class="mxinfo" id="T2:U603"><span class="fcn" id="F582N9:B815">minangle</span>( <span class="mxinfo" id="T2:U604"><span class="var type1" id="S2T70U817">yk</span>( <span class="mxinfo" id="T18:U606"><span class="mxinfo" id="T3:U607"><span class="mxinfo" id="T3:U608">9</span> + <span class="mxinfo" id="T3:U609"><span class="mxinfo" id="T3:U610">3</span>*<span class="var type1" id="S7T3U823">m1</span></span></span> + (<span class="mxinfo" id="T18:U612">2:3:<span class="mxinfo" id="T3:U613"><span class="mxinfo" id="T3:U614">3</span>*<span class="var type1" id="S8T3U831">m2</span></span></span>)</span>,<span class="var type1" id="S21T3U832">k</span> )</span>, <span class="mxinfo" id="T2:U617"><span class="var type1" id="S2T70U834">yk</span>( <span class="mxinfo" id="T18:U619"><span class="mxinfo" id="T3:U620"><span class="mxinfo" id="T3:U621">9</span> + <span class="mxinfo" id="T3:U622"><span class="mxinfo" id="T3:U623">3</span>*<span class="var type1" id="S7T3U840">m1</span></span></span> + (<span class="mxinfo" id="T18:U625">2:3:<span class="mxinfo" id="T3:U626"><span class="mxinfo" id="T3:U627">3</span>*<span class="var type1" id="S8T3U848">m2</span></span></span>)</span>,<span class="mxinfo" id="T3:U629">1</span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,116" id="srcline116">116</a></span><span class="line">        <span class="mxinfo" id="T2:U630"><span class="mxinfo" id="T2:U631"><span class="var type1" id="S2T70U853">yk</span>( <span class="mxinfo" id="T18:U633"><span class="mxinfo" id="T3:U634"><span class="mxinfo" id="T3:U635">9</span> + <span class="mxinfo" id="T3:U636"><span class="mxinfo" id="T3:U637">3</span>*<span class="var type1" id="S7T3U859">m1</span></span></span> + (<span class="mxinfo" id="T18:U639">3:3:<span class="mxinfo" id="T3:U640"><span class="mxinfo" id="T3:U641">3</span>*<span class="var type1" id="S8T3U867">m2</span></span></span>)</span>,<span class="var type1" id="S21T3U868">k</span> )</span> = <span class="mxinfo" id="T2:U644"><span class="fcn" id="F582N9:B870">minangle</span>( <span class="mxinfo" id="T2:U645"><span class="var type1" id="S2T70U872">yk</span>( <span class="mxinfo" id="T18:U647"><span class="mxinfo" id="T3:U648"><span class="mxinfo" id="T3:U649">9</span> + <span class="mxinfo" id="T3:U650"><span class="mxinfo" id="T3:U651">3</span>*<span class="var type1" id="S7T3U878">m1</span></span></span> + (<span class="mxinfo" id="T18:U653">3:3:<span class="mxinfo" id="T3:U654"><span class="mxinfo" id="T3:U655">3</span>*<span class="var type1" id="S8T3U886">m2</span></span></span>)</span>,<span class="var type1" id="S21T3U887">k</span> )</span>, <span class="mxinfo" id="T2:U658"><span class="var type1" id="S2T70U889">yk</span>( <span class="mxinfo" id="T18:U660"><span class="mxinfo" id="T3:U661"><span class="mxinfo" id="T3:U662">9</span> + <span class="mxinfo" id="T3:U663"><span class="mxinfo" id="T3:U664">3</span>*<span class="var type1" id="S7T3U895">m1</span></span></span> + (<span class="mxinfo" id="T18:U666">3:3:<span class="mxinfo" id="T3:U667"><span class="mxinfo" id="T3:U668">3</span>*<span class="var type1" id="S8T3U903">m2</span></span></span>)</span>,<span class="mxinfo" id="T3:U670">1</span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,117" id="srcline117">117</a></span><span class="line">        <span class="mxinfo" id="T2:U671"><span class="mxinfo" id="T2:U672"><span class="var type1" id="S2T70U908">yk</span>( <span class="mxinfo" id="T18:U674"><span class="mxinfo" id="T3:U675"><span class="mxinfo" id="T3:U676">9</span> + <span class="mxinfo" id="T3:U677"><span class="mxinfo" id="T3:U678">3</span>*(<span class="mxinfo" id="T3:U679"><span class="var type1" id="S7T3U916">m1</span>+<span class="var type1" id="S8T3U917">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U682">2:3:<span class="mxinfo" id="T3:U683"><span class="mxinfo" id="T3:U684">3</span>*<span class="var type1" id="S10T3U925">w1</span></span></span>)</span>,<span class="var type1" id="S21T3U926">k</span> )</span> = <span class="mxinfo" id="T2:U687"><span class="fcn" id="F582N9:B928">minangle</span>(<span class="mxinfo" id="T2:U688"><span class="var type1" id="S2T70U930">yk</span>( <span class="mxinfo" id="T18:U690"><span class="mxinfo" id="T3:U691"><span class="mxinfo" id="T3:U692">9</span> + <span class="mxinfo" id="T3:U693"><span class="mxinfo" id="T3:U694">3</span>*(<span class="mxinfo" id="T3:U695"><span class="var type1" id="S7T3U938">m1</span>+<span class="var type1" id="S8T3U939">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U698">2:3:<span class="mxinfo" id="T3:U699"><span class="mxinfo" id="T3:U700">3</span>*<span class="var type1" id="S10T3U947">w1</span></span></span>)</span>,<span class="var type1" id="S21T3U948">k</span> )</span>, <span class="mxinfo" id="T2:U703"><span class="var type1" id="S2T70U950">yk</span>( <span class="mxinfo" id="T18:U705"><span class="mxinfo" id="T3:U706"><span class="mxinfo" id="T3:U707">9</span> + <span class="mxinfo" id="T3:U708"><span class="mxinfo" id="T3:U709">3</span>*(<span class="mxinfo" id="T3:U710"><span class="var type1" id="S7T3U958">m1</span>+<span class="var type1" id="S8T3U959">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U713">2:3:<span class="mxinfo" id="T3:U714"><span class="mxinfo" id="T3:U715">3</span>*<span class="var type1" id="S10T3U967">w1</span></span></span>)</span>,<span class="mxinfo" id="T3:U717">1</span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,118" id="srcline118">118</a></span><span class="line">        <span class="mxinfo" id="T2:U718"><span class="mxinfo" id="T2:U719"><span class="var type1" id="S2T70U972">yk</span>( <span class="mxinfo" id="T18:U721"><span class="mxinfo" id="T3:U722"><span class="mxinfo" id="T3:U723">9</span> + <span class="mxinfo" id="T3:U724"><span class="mxinfo" id="T3:U725">3</span>*(<span class="mxinfo" id="T3:U726"><span class="var type1" id="S7T3U980">m1</span>+<span class="var type1" id="S8T3U981">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U729">3:3:<span class="mxinfo" id="T3:U730"><span class="mxinfo" id="T3:U731">3</span>*<span class="var type1" id="S10T3U989">w1</span></span></span>)</span>,<span class="var type1" id="S21T3U990">k</span> )</span> = <span class="mxinfo" id="T2:U734"><span class="fcn" id="F582N9:B992">minangle</span>(<span class="mxinfo" id="T2:U735"><span class="var type1" id="S2T70U994">yk</span>( <span class="mxinfo" id="T18:U737"><span class="mxinfo" id="T3:U738"><span class="mxinfo" id="T3:U739">9</span> + <span class="mxinfo" id="T3:U740"><span class="mxinfo" id="T3:U741">3</span>*(<span class="mxinfo" id="T3:U742"><span class="var type1" id="S7T3U1002">m1</span>+<span class="var type1" id="S8T3U1003">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U745">3:3:<span class="mxinfo" id="T3:U746"><span class="mxinfo" id="T3:U747">3</span>*<span class="var type1" id="S10T3U1011">w1</span></span></span>)</span>,<span class="var type1" id="S21T3U1012">k</span> )</span>, <span class="mxinfo" id="T2:U750"><span class="var type1" id="S2T70U1014">yk</span>( <span class="mxinfo" id="T18:U752"><span class="mxinfo" id="T3:U753"><span class="mxinfo" id="T3:U754">9</span> + <span class="mxinfo" id="T3:U755"><span class="mxinfo" id="T3:U756">3</span>*(<span class="mxinfo" id="T3:U757"><span class="var type1" id="S7T3U1022">m1</span>+<span class="var type1" id="S8T3U1023">m2</span></span>)</span></span> + (<span class="mxinfo" id="T18:U760">3:3:<span class="mxinfo" id="T3:U761"><span class="mxinfo" id="T3:U762">3</span>*<span class="var type1" id="S10T3U1031">w1</span></span></span>)</span>,<span class="mxinfo" id="T3:U764">1</span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="127,119" id="srcline119">119</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,120" id="srcline120">120</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="127,121" id="srcline121">121</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="127,122" id="srcline122">122</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
